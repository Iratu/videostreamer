<style type="text/css">
    .drag {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        outline-style: none;
    }
    .silent {
        opacity: 0.5;
    }

    .owner {
        background: #fafffa;
    }

    .onlines {
        background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAJElEQVQIW2NkwASSjGhikgwMDM+RBcECIEUwQbgATBBFACQIAKWBBB8HjQwoAAAAAElFTkSuQmCC) repeat;
    }

    .messagebody p {
        margin: 0;
    }
</style>

<script type="text/ng-template" id="message.html">
    <div ng-class="{owner: message.owner}">
        <div id="anchor" ng-if="message.anchor"></div>
        <a href="" style="float:right" ng-click="messageref(message.id)">&gt;&gt;{{message.id}}</a>
        <div style="clear: both"></div>

        <div style="float: right; white-space: nowrap">
            {{ message.posted | sincify }}
            <img width="16" height="16" tooltip-placement="left" tooltip-append-to-body="true" tooltip-html-unsafe="{{{hash: message.hash, name: message.username} | zoomicon}}" ng-src="{{message.remoteHash | identicon}}">
        </div>
        <div style="clear: both"></div>
        <img width="32" height="32" tooltip-placement="right" tooltip-append-to-body="true" tooltip="{{message.username}}" style="float: left; margin-right: 4px; margin-bottom: 4px" ng-src="{{message.hash | identicon}}">
        <div style="word-wrap: break-word" bakemessage="message.root" class="messagebody"></div>
        <div style="clear: both"></div>
    </div>
</script>

<div ng-controller="player" id="player" style="display: flex; flex-grow: 1; overflow: hidden; width: 80%" ng-class="{fullwidth: !showchat}" ng-if="showvideo">
    <div param="" style="flex-grow: 1; position: relative; background-color: #000000; {{(flashinited && stream.image) ? 'background-size: contain' : ''}} ; background-image: url('{{(flashinited && stream.image) ? stream.image : '/static/img/spinner.gif'}}'); background-repeat: no-repeat; background-position: 50% 50%;" >
    </div>
</div>
<div playhorizresize="" class="drag" style="width: 4px; background: #eee; position: relative; overflow: hidden; cursor: ew-resize" ng-show="showvideo && showchat"></div>
<div ng-controller="chat" id="chat" style="flex-grow: 1; width: 20%; overflow: hidden; position: relative" ng-class="{fullwidth: !showvideo}" ng-if="showchat">
    <div style="position: absolute; wdith: auto; height: auto; overflow: hidden; top: 0; left: 0; right: 0; bottom: 0">
        <div id="messages" style="height: 80%; display: flex; flex-direction: column;">
            <div id="scroller" style="flex-grow: 1; position: relative; overflow: auto">
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; padding: 4px;">
                    <a href="" ng-if="hashistory" style="text-align: center; display: block; font-size: large" ng-click="loadHistory(messages[0].id)">...</a>
                    <div id="{{$first ? 'messagefirst' : ''}}" ng-repeat="message in messages" ng-include="'message.html'" style="border-top: 1px solid #eee"></div>
                </div>
            </div>
            <div class="onlines" style="flex-shrink: 0">
                <img width="16" height="16" style="margin-left: 4px; margin-bottom: 2px; margin-right: 4px" tooltip-html-unsafe="{{owner | zoomicon}}" tooltip-append-to-body="true" ng-if="owner" ng-class="{silent: !owner.typing}"  ng-src="{{owner.hash | identicon}}"/>
                <div style="width: 24px; display: inline-block" ng-if="!owner"></div>
                <img width="16" height="16" style="margin-bottom: 2px" ng-repeat="o in online" tooltip-html-unsafe="{{o | zoomicon}}" tooltip-append-to-body="true" ng-class="{silent: !o.typing}" ng-src="{{o.hash | identicon}}"/>
            </div>
            <div playvertresize="" style="flex-shrink:0; height: 4px; background: #eee; cursor: ns-resize"></div>
        </div>
        <div id="input" style="height: 20%; overflow: hidden;">
            <textarea placeholder="Type here" maxlength="250" chat-typer style="resize: none; outline: 0; border: 0; display: block; width: 100%; height: 100%"></textarea>
        </div>
    </div>
</div>